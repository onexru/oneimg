import{N as b}from"./NavBar-BtXCAw3x.js";import{_ as z,r as _,o as y,c as n,b as i,i as w,e as s,d as p,t as e,F as k,j as B,g as N,n as S}from"./index-BcmoEdYw.js";const x={class:"stats"},M={class:"stats-content"},C={key:0,class:"loading-container"},F={key:1,class:"stats-grid"},T={class:"stat-card"},L={class:"stat-content"},V={class:"stat-number"},j={class:"stat-card"},D={class:"stat-content"},E={class:"stat-number"},I={class:"stat-card"},A={class:"stat-content"},G={class:"stat-number"},H={class:"stat-card"},K={class:"stat-content"},$={class:"stat-number"},q={class:"stat-card"},J={class:"stat-content"},O={class:"stat-number"},P={class:"stat-card"},Q={class:"stat-content"},R={class:"stat-number"},U={key:2,class:"detailed-stats"},W={class:"detail-section"},X={class:"trend-chart"},Y={class:"trend-count"},Z={class:"trend-date"},ss={class:"detail-section"},ts={class:"storage-info"},as={class:"storage-item"},os={class:"storage-value"},es={class:"storage-item"},ls={class:"storage-value"},ns={class:"storage-item"},is={class:"storage-value"},ds={__name:"Stats",setup(rs){const u=_(!1),o=_({total_images:0,total_size:0,today_uploads:0,month_uploads:0,average_size:0,max_size:0,type_distribution:[],upload_trend:[]}),r=_({show:!1,message:"",type:"success"}),m=async()=>{u.value=!0;try{const a=await fetch("/api/stats/dashboard",{headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`}});if(a.ok){const t=await a.json();o.value=t.data||o.value}else throw new Error("加载统计数据失败")}catch(a){console.error("加载统计数据错误:",a),f("加载统计数据失败: "+a.message,"error")}finally{u.value=!1}},v=a=>a?a.toLocaleString("zh-CN"):"0",c=a=>{if(!a)return"0 B";const t=1024,l=["B","KB","MB","GB","TB"],d=Math.floor(Math.log(a)/Math.log(t));return parseFloat((a/Math.pow(t,d)).toFixed(2))+" "+l[d]},h=(a,t)=>{if(!t||t.length===0)return 0;const l=Math.max(...t.map(d=>d.count));return l>0?a/l*100:0},g=a=>new Date(a).toLocaleDateString("zh-CN",{month:"short",day:"numeric"}),f=(a,t="success")=>{r.value={show:!0,message:a,type:t},setTimeout(()=>{r.value.show=!1},3e3)};return y(()=>{m()}),(a,t)=>(i(),n("div",x,[w(b),s("div",M,[t[18]||(t[18]=s("div",{class:"stats-header"},[s("h1",{class:"stats-title"},"系统统计"),s("p",{class:"stats-subtitle"},"查看图床系统的使用情况和统计数据")],-1)),u.value?(i(),n("div",C,[...t[0]||(t[0]=[s("div",{class:"spinner"},null,-1),s("p",null,"加载统计数据中...",-1)])])):(i(),n("div",F,[s("div",T,[t[2]||(t[2]=s("div",{class:"stat-icon"},"📷",-1)),s("div",L,[s("h3",V,e(v(o.value.total_images)),1),t[1]||(t[1]=s("p",{class:"stat-label"},"总图片数",-1))])]),s("div",j,[t[4]||(t[4]=s("div",{class:"stat-icon"},"💾",-1)),s("div",D,[s("h3",E,e(c(o.value.total_size)),1),t[3]||(t[3]=s("p",{class:"stat-label"},"总存储空间",-1))])]),s("div",I,[t[6]||(t[6]=s("div",{class:"stat-icon"},"📈",-1)),s("div",A,[s("h3",G,e(v(o.value.today_uploads)),1),t[5]||(t[5]=s("p",{class:"stat-label"},"今日上传",-1))])]),s("div",H,[t[8]||(t[8]=s("div",{class:"stat-icon"},"📊",-1)),s("div",K,[s("h3",$,e(v(o.value.month_uploads)),1),t[7]||(t[7]=s("p",{class:"stat-label"},"本月上传",-1))])]),s("div",q,[t[10]||(t[10]=s("div",{class:"stat-icon"},"📏",-1)),s("div",J,[s("h3",O,e(c(o.value.average_size)),1),t[9]||(t[9]=s("p",{class:"stat-label"},"平均文件大小",-1))])]),s("div",P,[t[12]||(t[12]=s("div",{class:"stat-icon"},"🔝",-1)),s("div",Q,[s("h3",R,e(c(o.value.max_size)),1),t[11]||(t[11]=s("p",{class:"stat-label"},"最大文件大小",-1))])])])),u.value?p("",!0):(i(),n("div",U,[s("div",W,[t[13]||(t[13]=s("h2",{class:"section-title"},"最近7天上传趋势",-1)),s("div",X,[(i(!0),n(k,null,B(o.value.upload_trend,(l,d)=>(i(),n("div",{key:d,class:"trend-bar"},[s("div",{class:"trend-fill",style:S({height:h(l.count,o.value.upload_trend)+"%"})},null,4),s("span",Y,e(l.count),1),s("span",Z,e(g(l.date)),1)]))),128))])]),s("div",ss,[t[17]||(t[17]=s("h2",{class:"section-title"},"存储使用情况",-1)),s("div",ts,[s("div",as,[t[14]||(t[14]=s("span",{class:"storage-label"},"已使用空间:",-1)),s("span",os,e(c(o.value.total_size)),1)]),s("div",es,[t[15]||(t[15]=s("span",{class:"storage-label"},"图片数量:",-1)),s("span",ls,e(v(o.value.total_images))+" 个",1)]),s("div",ns,[t[16]||(t[16]=s("span",{class:"storage-label"},"平均大小:",-1)),s("span",is,e(c(o.value.average_size)),1)])])])]))]),r.value.show?(i(),n("div",{key:0,class:N(["notification",r.value.type])},e(r.value.message),3)):p("",!0)]))}},vs=z(ds,[["__scopeId","data-v-8ef52650"]]);export{vs as default};
